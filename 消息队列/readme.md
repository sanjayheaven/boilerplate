# 消息队列

参考博客 [什么是消息队列](https://www.zhihu.com/question/54152397)

## 使用场景

异步处理，应用解耦，流量削锋和消息通讯四个场景。  
日常一般只使用前三个

### 解耦

业务逻辑 A B C 需要优先调用，其中 B，C 是次要任务  
其中 B,C 依赖于 A 的信息，（服务同级调用）  
那这样对于 A 来说，建立一个消息队列，供 B，C 或者未来的 D 使用，这样就解耦了  
否则，B，C 暴露给接口，任何改动，对于 A 来说 都要改动接口。

### 异步

对于主要业务 A 来说，完成 A 之后可以直接返回，BC 可以在后台消费。

- 主要接口调用时长，永远是 A
- 提高了用户体验和吞吐量

### 限流/削锋

处理高并发请求，多余请求放入队列中。

## 问题

- 系统复杂性 ，多了维护这么一个队列中间件，肯定更复杂
- 数据一致性，队列挂了，数据丢失
- 消费者怎么获取队列中数据
  - 生产者主动 push
  - 消费者轮询
